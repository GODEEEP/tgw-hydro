import pandas as pd
import numpy as np
import os
import sys

huc2 = int(sys.argv[1])
data_path = f'/vast/projects/godeeep/VIC/calibration/{huc2}'

grid = pd.read_csv('../data/grid_ids_conus.csv')

ids = [208228, 208229, 208230, 208231, 208232, 208233, 208234, 208235,
       208236, 208237, 208238, 208239, 208240, 208241, 208242, 208245,
       208246, 208247, 208248, 208249, 208250, 208251, 208252, 208253,
       208254, 208255, 208256, 208262, 208263, 208264, 208265, 208272,
       208273, 208274, 208282, 208283, 208284, 208285, 208286, 208287,
       208296, 208297, 208298, 208308, 208309, 208310, 208311, 208312,
       208313, 208314, 208315, 208316, 208317, 208318, 208326, 208327,
       208328, 208329, 208339, 208340, 208341, 208342, 208343, 208344,
       208345, 208346, 208347, 208351, 208352, 208353, 208354, 208355,
       208356, 208357, 208358, 208359, 208360, 208368, 208369, 208370,
       208371, 208372, 208378, 208379, 208380, 208381, 208382, 208384,
       208385, 208386, 208387, 208395, 208396, 208397, 208398, 208399,
       208400, 208401, 208402, 208403, 208404, 208413, 208414, 208415,
       208416, 208417, 208422, 208423, 208424, 208443, 208444, 208445,
       208446, 208447, 208448, 208449, 208450, 208451, 208462, 208463,
       208464, 208465, 208466, 208472, 208473, 208495, 208496, 208497,
       208498, 208499, 208500, 208501, 208502, 208516, 208517, 208518,
       208519, 208520, 208521, 208526, 208549, 208552, 208553, 208554,
       208555, 208556, 208557, 208558, 208559, 208560, 208561, 208562,
       208563, 208564, 208579, 208580, 208581, 208582, 208583, 208616,
       208617, 208618, 208619, 208620, 208621, 208622, 208623, 208624,
       208625, 208626, 208627, 208628, 208629, 208630, 208631, 208632,
       208633, 208634, 208635, 208636, 208637, 208655, 208656, 208657,
       208658, 208659, 208700, 208701, 208702, 208703, 208704, 208705,
       208706, 208707, 208708, 208709, 208710, 208711, 208712, 208713,
       208714, 208715, 208716, 208717, 208718, 208719, 208720, 208721,
       208722, 208723, 208724, 208725, 208726, 208743, 208744, 208745,
       208746, 208751, 208795, 208796, 208797, 208798, 208799, 208800,
       208801, 208802, 208803, 208804, 208805, 208806, 208807, 208808,
       208809, 208810, 208811, 208812, 208813, 208814, 208815, 208816,
       208817, 208818, 208819, 208820, 208821, 208822, 208823, 208826,
       208827, 208828, 208847, 208848, 208849, 208850, 208883, 208902,
       208903, 208904, 208905, 208906, 208907, 208908, 208909, 208910,
       208911, 208912, 208913, 208914, 208915, 208916, 208917, 208918,
       208919, 208920, 208921, 208923, 208924, 208925, 208926, 208927,
       208928, 208932, 208951, 208952, 208953, 208954, 208955, 209014,
       209015, 209026, 209027, 209030, 209031, 209032, 209034, 209038,
       209057, 209058, 209059, 209060, 209130, 209131, 209138, 209142,
       209161, 209162, 209163, 209164, 209236, 209237, 209267, 209268,
       209269, 209270, 209306, 209343, 209344, 209375, 209376, 209377,
       209450, 209451, 209474, 209475, 209478, 209479, 209480, 209481,
       209482, 209483, 209486, 209487, 209488, 209492, 209493, 209494,
       209497, 209499, 209500, 209501, 209506, 209507, 209509, 209510,
       209514, 209515, 209517, 209519, 209520, 209559, 209560, 209590,
       209591, 209592, 209599, 209698, 209699, 209700, 209701, 209706,
       209710, 209711, 209780, 209810, 209811, 209812, 209813, 209814,
       209821, 209822, 209823, 209824, 209892, 209923, 209924, 209925,
       209926, 209927, 209930, 209931, 209932, 209933, 209934, 209935,
       209936, 209937, 209938, 210037, 210038, 210039, 210040, 210041,
       210042, 210043, 210044, 210045, 210046, 210047, 210048, 210049,
       210050, 210051, 210119, 210151, 210152, 210153, 210154, 210155,
       210156, 210157, 210158, 210159, 210160, 210161, 210162, 210163,
       210164, 210165, 210233, 210265, 210266, 210267, 210268, 210269,
       210270, 210271, 210272, 210273, 210274, 210275, 210276, 210277,
       210278, 210279, 210366, 210367, 210379, 210380, 210381, 210382,
       210383, 210384, 210385, 210387, 210388, 210389, 210390, 210391,
       210392, 210393, 210480, 210481, 210482, 210493, 210494, 210495,
       210496, 210497, 210498, 210499, 210500, 210501, 210502, 210503,
       210504, 210505, 210506, 210507, 210591, 210597, 210606, 210607,
       210608, 210609, 210610, 210611, 210612, 210614, 210615, 210616,
       210617, 210618, 210619, 210620, 210621, 210705, 210712, 210720,
       210721, 210722, 210723, 210724, 210725, 210726, 210727, 210728,
       210730, 210731, 210732, 210733, 210734, 210735, 210788, 210790,
       210818, 210819, 210820, 210821, 210823, 210827, 210828, 210834,
       210835, 210836, 210837, 210838, 210839, 210840, 210844, 210845,
       210846, 210847, 210848, 210849, 210933, 210934, 210940, 210941,
       210942, 210948, 210949, 210950, 210951, 210952, 210954, 210955,
       210957, 210958, 210959, 210960, 210961, 210962, 211049, 211054,
       211055, 211056, 211062, 211063, 211064, 211065, 211066, 211067,
       211068, 211069, 211070, 211071, 211072, 211073, 211074, 211075,
       211076, 211160, 211161, 211162, 211169, 211170, 211173, 211174,
       211175, 211176, 211177, 211178, 211179, 211180, 211181, 211182,
       211183, 211184, 211185, 211186, 211274, 211275, 211276, 211277,
       211281, 211285, 211286, 211287, 211288, 211289, 211290, 211295,
       211296, 211297, 211298, 211299, 211300, 211387, 211388, 211389,
       211394, 211395, 211399, 211400, 211401, 211402, 211403, 211404,
       211405, 211407, 211408, 211409, 211410, 211411, 211412, 211413,
       211502, 211503, 211507, 211508, 211509, 211512, 211513, 211514,
       211515, 211516, 211517, 211518, 211519, 211521, 211522, 211523,
       211524, 211525, 211526, 211550, 211611, 211612, 211614, 211615,
       211616, 211617, 211618, 211619, 211620, 211621, 211622, 211623,
       211624, 211625, 211626, 211627, 211628, 211631, 211632, 211633,
       211720, 211721, 211722, 211723, 211724, 211725, 211726, 211727,
       211728, 211729, 211731, 211732, 211733, 211734, 211735, 211829,
       211830, 211831, 211837, 211838, 211839, 211840, 211841, 211842,
       211947, 211948, 211967, 211968, 211970, 211971, 211973, 211975,
       211979, 211980, 211981, 211984, 211986, 211987, 211994, 211995,
       211996, 211997, 211998, 211999, 212000, 212003, 212005, 212006,
       212008, 212009, 212010, 212011, 212012, 212013, 212635, 212636,
       212698, 212699, 212700, 212729, 212730, 212792, 212793, 213268,
       214873, 216503, 221519, 224842, 228165, 231488]


for cell_id in ids:
  print(cell_id)

  row = grid[(grid.huc2 == huc2) & (grid.id == cell_id)]
  lon = float(row.lon)
  lat = float(row.lat)
  path = f'{data_path}/{cell_id:07}_{lon:0.5f}_{lat:0.5f}'

  status_fn = os.path.join(path, 'OstStatus0.txt')

  if os.path.exists(status_fn):
    os.unlink(status_fn)
    print(status_fn)
